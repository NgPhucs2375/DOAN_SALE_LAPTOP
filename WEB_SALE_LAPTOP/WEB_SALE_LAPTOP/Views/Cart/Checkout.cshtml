@model List<WEB_SALE_LAPTOP.Models.CartItem>

@{
    ViewBag.Title = "Thanh toán đơn hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section styles {
    @Styles.Render("~/Content/css/checkout")
}
<div class="cart-stepper">
    <div class="step active">
        <div class="step-icon"><i class="fa-solid fa-cart-shopping"></i></div>
        <div class="step-label">1. Giỏ hàng</div>
    </div>
    <div class="step-divider active"></div> <div class="step active">
        <div class="step-icon"><i class="fa-solid fa-credit-card"></i></div>
        <div class="step-label">2. Thanh toán</div>
    </div>
    <div class="step-divider"></div>

    <div class="step">
        <div class="step-icon"><i class="fa-solid fa-check-circle"></i></div>
        <div class="step-label">3. Hoàn tất</div>
    </div>
</div>

<h2 class="section-title">@ViewBag.Title</h2>

@if (TempData["CheckoutError"] != null)
{
    <div class="voucher-message error" style="margin-bottom: 1.5rem;">
        @TempData["CheckoutError"]
    </div>
}

@using (Html.BeginForm("PlaceOrder", "Cart", FormMethod.Post))
{
    <div class="cart-page-wrapper">

        <div class="product-section">
            <h3 class="summary-title" style="text-align: left; margin-bottom: 1.5rem;">
                <i class="fa-solid fa-truck-fast"></i> Thông tin giao hàng
            </h3>

            <div class="form-group">
                <label for="HOTEN_GIAO">Họ tên (nếu có)</label>
                <input type="text" name="HOTEN_GIAO" class="form-group-input" value="@ViewBag.HoTen" />
            </div>

            <div class="form-group">
                <label for="SDT_GIAO">Số điện thoại *</label>
                <input type="tel" name="SDT_GIAO" class="form-group-input" value="@ViewBag.SoDT" required />
            </div>

            <div class="form-group">
                <label for="DIACHI_GIAO">Địa chỉ giao hàng *</label>
                <textarea name="DIACHI_GIAO" class="form-group-input" rows="4" required>@ViewBag.DiaChi</textarea>
            </div>
        </div>

        <div class="cart-summary">
            <h3 class="summary-title">Đơn hàng của bạn</h3>

            <div class="summary-section summary-product-list">
                @foreach (var item in Model)
                {
                    <div class="summary-product-row">
                        <img src="~/Content/images/@item.HinhAnh" class="summary-product-img" />
                        <div class="summary-product-info">
                            <span class="summary-product-name">@item.TenLaptop (x @item.SoLuong)</span>
                        </div>
                        <span class="summary-product-total">@item.ThanhTien.ToString("N0") ₫</span>
                    </div>
                }
            </div>

            <div class="summary-section total-calc">
                <div class="summary-row">
                    <span>Tạm tính</span>
                    <strong>@ViewBag.TongTien.ToString("N0") ₫</strong>
                </div>
                <div class="summary-row discount">
                    <span>Giảm giá</span>
                    <strong>-@ViewBag.SoTienGiam.ToString("N0") ₫</strong>
                </div>
                <div class="summary-row final-total">
                    <span>Tổng cộng</span>
                    <strong>@ViewBag.TongThanhToan.ToString("N0") ₫</strong>
                </div>
            </div>

            <div class="summary-section">
                <button type="submit" class="cart-button btn-checkout">
                    <i class="fa-solid fa-lock"></i>
                    XÁC NHẬN ĐẶT HÀNG
                </button>
            </div>
        </div>
    </div>
}